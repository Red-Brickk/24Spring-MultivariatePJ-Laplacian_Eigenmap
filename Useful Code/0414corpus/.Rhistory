k <- 10
le1 <- do.lapeig(df,dim=3, type=c("knn",k), weighted=FALSE)
df_le1 <- as.data.frame(le1$Y)
colnames(df_le1) <- c("dim1","dim2","dim3")
le1 <- do.lapeig(df,dim=3, type=c("knn",k), weighted=FALSE)
le1
le1 <- do.lapeig(df,dim=2, type=c("knn",k), weighted=FALSE)
le1
le1 <- do.lapeig(df,dim=3, type=c("knn",k), weighted=FALSE)
le1
df
matrix(df)
as.matrix(df)
df_mat <- as.matrix(df)
df_mat <- as.matrix(df, nrow=nrow(df))
nrow(df)
df_mat <- as.matrix(df, nrows=nrow(df))
rm(df_mat)
df_mat <- as.matrix(df, nrows=nrow(df))
df_mat
?as.matrix
nrow(df_mat)
ncol(df_mat)
df_mat
df
df_mat <- as.matrix(df[,2:601], nrows=nrow(df))
ncol(df_mat)
le1 <- do.lapeig(df_mat,dim=2, type=c("knn",k), weighted=FALSE)
df_le1 <- as.data.frame(le1$Y)
colnames(df_le1) <- c("dim1","dim2","dim3")
le1 <- do.lapeig(df_mat,dim=3, type=c("knn",k), weighted=FALSE)
df_le1 <- as.data.frame(le1$Y)
colnames(df_le1) <- c("dim1","dim2","dim3")
le1 <- do.lapeig(df_mat,dim=3, type=c("knn",k), weighted=FALSE)
le1
le1 <- do.lapeig(df_mat,dim=5, type=c("knn",k), weighted=FALSE)
le1$Y
le1$eigvals
le1 <- do.lapeig(df_mat,dim=5)
le1$Y
my_lapeig <- function(dframe,k, t,ndim){
# 步驟2：使用熱核權重和k最近鄰計算鄰接矩陣
k <- 10  # 最近鄰居的數量
t <- 2   # 熱核參數
dist_matrix <- as.matrix(dist(dframe))  # 歐幾里得距離矩陣
# 計算熱核權重
weight_matrix <- exp(-dist_matrix^2 / t)
# 保留每行k+1個最小值（自身和k個鄰居）
adj_matrix <- apply(weight_matrix, 1, function(row) {
smallest <- order(row, decreasing = TRUE)[1:(k+1)]
weights <- rep(0, length(row))
weights[smallest] <- row[smallest]
weights
})
adj_matrix <- (adj_matrix + t(adj_matrix)) / 2  # 確保矩陣是對稱的
# 步驟3：構造圖拉普拉斯
D <- diag(rowSums(adj_matrix))  # 度矩陣，加權度為各行之和
L <- D - adj_matrix  # 未規範化的拉普拉斯
# 步驟4：進行特徵分解
eigen_result <- eigs_sym(L, k = ndim, which = "SM")  # 計算最小的特徵值
low_dim_embedding <- eigen_result$vectors  # 低維嵌入
return(list(L = L, eigenvalues = eigen_result$values[1:ndim], eigenvectors = low_dim_embedding))
}
my_lapeig(dframe=df,k=10,t=2,ndim=4)
rownames(df)
rownames(df) <- df[,1]
rownames(df)
setwd("D:/Study/Courses/2024Spring/multivariate/Project/code/0414corpus")
rawdf <- read.csv("corpus_neighboring_embedding_matrix.csv")
df <- rawdf[,2:601]
rownames(df) <- rawdf[,1]
View(df)
## try different levels of connectivity
for(k in c(10)){
k <- 10
df_mat <- as.matrix(df, nrows=nrow(df))
le1 <- do.lapeig(df_mat,dim=5, type=c("knn",k), weighted=FALSE)
df_le1 <- as.data.frame(le1$Y)
colnames(df_le1) <- c("dim1","dim2","dim3")
# df_le1$lab <- sub_swiss$t
fig_le1 <- plot_ly(df_le1, x=~dim2, y=~dim3,size = c(0.8))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2, k=',k), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
}
## try different levels of connectivity
for(k in c(10)){
k <- 10
df_mat <- as.matrix(df, nrows=nrow(df))
le1 <- do.lapeig(df_mat,dim=5, type=c("knn",k), weighted=FALSE)
df_le1 <- as.data.frame(le1$Y)
colnames(df_le1) <- c("dim1","dim2")
# df_le1$lab <- sub_swiss$t
fig_le1 <- plot_ly(df_le1, x=~dim2, y=~dim3,size = c(0.8))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2, k=',k), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
}
# df_le1$lab <- sub_swiss$t
fig_le1 <- plot_ly(df_le1, x=~dim1, y=~dim2,size = c(0.8))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2, k=',k), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_lapeig <- function(dframe,k, t,ndim){
# 步驟2：使用熱核權重和k最近鄰計算鄰接矩陣
dist_matrix <- as.matrix(dist(dframe))  # 歐幾里得距離矩陣
# 計算熱核權重
weight_matrix <- exp(-dist_matrix^2 / t)
# 保留每行k+1個最小值（自身和k個鄰居）
adj_matrix <- apply(weight_matrix, 1, function(row) {
smallest <- order(row, decreasing = TRUE)[1:(k+1)]
weights <- rep(0, length(row))
weights[smallest] <- row[smallest]
weights
})
adj_matrix <- (adj_matrix + t(adj_matrix)) / 2  # 確保矩陣是對稱的
# 步驟3：構造圖拉普拉斯
D <- diag(rowSums(adj_matrix))  # 度矩陣，加權度為各行之和
L <- D - adj_matrix  # 未規範化的拉普拉斯
# 步驟4：進行特徵分解
eigen_result <- eigs_sym(L, k = ndim, which = "SM")  # 計算最小的特徵值
low_dim_embedding <- eigen_result$vectors  # 低維嵌入
return(list(L = L, eigenvalues = eigen_result$values[1:ndim], eigenvectors = low_dim_embedding))
}
my_lapeig(dframe=df,k=10,t=2,ndim=4)
library(igraph)
library(RSpectra)
my_lapeig <- function(dframe,k, t,ndim){
# 步驟2：使用熱核權重和k最近鄰計算鄰接矩陣
dist_matrix <- as.matrix(dist(dframe))  # 歐幾里得距離矩陣
# 計算熱核權重
weight_matrix <- exp(-dist_matrix^2 / t)
# 保留每行k+1個最小值（自身和k個鄰居）
adj_matrix <- apply(weight_matrix, 1, function(row) {
smallest <- order(row, decreasing = TRUE)[1:(k+1)]
weights <- rep(0, length(row))
weights[smallest] <- row[smallest]
weights
})
adj_matrix <- (adj_matrix + t(adj_matrix)) / 2  # 確保矩陣是對稱的
# 步驟3：構造圖拉普拉斯
D <- diag(rowSums(adj_matrix))  # 度矩陣，加權度為各行之和
L <- D - adj_matrix  # 未規範化的拉普拉斯
# 步驟4：進行特徵分解
eigen_result <- eigs_sym(L, k = ndim, which = "SM")  # 計算最小的特徵值
low_dim_embedding <- eigen_result$vectors  # 低維嵌入
return(list(L = L, eigenvalues = eigen_result$values[1:ndim], eigenvectors = low_dim_embedding))
}
my_lapeig(dframe=df,k=10,t=2,ndim=4)
my_L <- my_lapeig(dframe=df,k=10,t=2,ndim=4)$L
my_eig_vecs <- my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors
View(my_eig_vecs)
View(my_eig_vecs)
my_eig_vecs <- my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2)
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
fig_le1 <- plot_ly(my_eig_vecs, x=~dim2, y=~dim3)
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4)
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
plot(my_eig_vecs$dim3, my_eig_vecs$dim4)
plot(my_eig_vecs$dim3, my_eig_vecs$dim4)
text(my_eig_vecs$dim3, my_eig_vecs$dim4, labels = rownames(my_eig_vecs), pos = 3)
plot(my_eig_vecs$dim3, my_eig_vecs$dim4)
text(my_eig_vecs$dim3, my_eig_vecs$dim4, labels = rownames(df), pos = 3)
plot(my_eig_vecs$dim3, my_eig_vecs$dim4)
text(my_eig_vecs$dim3, my_eig_vecs$dim4, labels = rownames(df), pos = 3)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim3, my_eig_vecs$dim4)
text(my_eig_vecs$dim3, my_eig_vecs$dim4, labels = rownames(df), pos = 3, cex=0.5)
fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim3, my_eig_vecs$dim4)
text(my_eig_vecs$dim3, my_eig_vecs$dim4, labels = rownames(df), pos = 3, cex=0.5)
#
#
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
plot(my_eig_vecs$dim3, my_eig_vecs$dim4,xlim=c(-0.10,-0.05), ylim = c(0,0.1))
text(my_eig_vecs$dim3, my_eig_vecs$dim4, labels = rownames(df), pos = 3, cex=0.5)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim3, my_eig_vecs$dim4,xlim=c(-0.10,0), ylim = c(0,0.1))
text(my_eig_vecs$dim3, my_eig_vecs$dim4, labels = rownames(df), pos = 3, cex=0.5)
#
#
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,xlim=c(-0.10,0), ylim = c(0,0.1))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
#
#
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
plot(my_eig_vecs$dim1, my_eig_vecs$dim2)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2)
# plot(my_eig_vecs$dim1, my_eig_vecs$dim2,xlim=c(-0.10,0), ylim = c(0,0.1))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
#
#
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,xlim = c(0,0.05))
# plot(my_eig_vecs$dim1, my_eig_vecs$dim2,xlim=c(-0.10,0), ylim = c(0,0.1))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
#
#
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,ylim = c(0,0.05))
# plot(my_eig_vecs$dim1, my_eig_vecs$dim2,xlim=c(-0.10,0), ylim = c(0,0.1))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
#
#
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,ylim = c(0,0.05))
# plot(my_eig_vecs$dim1, my_eig_vecs$dim2,xlim=c(-0.10,0), ylim = c(0,0.1))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=2,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,ylim = c(0,0.05))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=1,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,ylim = c(0,0.05))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=1000,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=100,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
```
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=100,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=1,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,ylim = c(0,0.05))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,ylim = c(0,0.05))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
load(file="horizontal_bars.Rda")
load(file="vertical_bars.Rda")
my_eig_vecs <- as.data.frame(my_lapeig(dframe=df,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,ylim = c(0,0.05))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
# fig_le1 <- plot_ly(my_eig_vecs, x=~dim3, y=~dim4,text = rownames(df))
# fig_le1 <- fig_le1 %>% add_markers()
# fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'),
#             plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
#          yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
# print(fig_le1)
horizontal_list
View(horizontal_list)
rm(horizontal_list)
load(file="vertical_bars.Rda")
knitr::opts_chunk$set(echo = TRUE)
bar_w <- 2
bar_l <- 10
n <- 100
vertical_list <- list()
for(i in 1:n){
left <- as.integer(((40-bar_w)*runif(1, 0, 1)+1))
up <- as.integer((40-bar_l)*runif(1, 0, 1)+1)
img <- get_img(left, up,bar_w, bar_l)
img <- matrix(img, nrow = 1)
vertical_list[[i]] <- img
}
get_img <- function(left,up,bar_w,bar_l){
if (left<1 | up<1 | left+bar_w>40 | up+bar_l>40){
return(NULL)
}
img <- matrix(0,nrow=40,ncol=40)
img[up:(up+bar_l),left:(left+bar_w)] = 1
return(img)
}
bar_w <- 2
bar_l <- 10
n <- 100
vertical_list <- list()
for(i in 1:n){
left <- as.integer(((40-bar_w)*runif(1, 0, 1)+1))
up <- as.integer((40-bar_l)*runif(1, 0, 1)+1)
img <- get_img(left, up,bar_w, bar_l)
img <- matrix(img, nrow = 1)
vertical_list[[i]] <- img
}
save(vertical_list, file="vertical_bars.Rda")
bar_w <- 10
bar_l <- 2
n <- 100
horizontal_list <- list()
for(i in 1:n){
left <- as.integer(((40-bar_w)*runif(1, 0, 1)+1))
up <- as.integer((40-bar_l)*runif(1, 0, 1)+1)
img <- get_img(left, up,bar_w, bar_l)
img <- matrix(img, nrow = 1)
horizontal_list[[i]] <- img
}
save(horizontal_list, file="horizontal_bars.Rda")
load(file="horizontal_bars.Rda")
load(file="vertical_bars.Rda")
class(horizontal_list)
View(horizontal_list)
toy <- as.data.frame(horizontal_list)
View(toy)
load(file="horizontal_bars.Rda")
load(file="vertical_bars.Rda")
# Convert list of arrays to dataframe
df <- do.call(rbind, lapply(horizontal_list, as.data.frame))
# Optional: Add a column for observation number
df$observation <- rep(1:100, each = nrow(horizontal_list[[1]]))
# View the dataframe
head(df)
# toy <- as.data.frame(horizontal_list)
# Optional: Add a column for observation number
df$observation <- NULL
# View the dataframe
head(df)
# Convert list of arrays to dataframe
toy_horizontal <- do.call(rbind, lapply(horizontal_list, as.data.frame))
# Convert list of arrays to dataframe
toy_horizontal <- do.call(rbind, lapply(horizontal_list, as.data.frame))
# Convert list of arrays to dataframe
toy_horizontal <- do.call(rbind, lapply(horizontal_list, as.data.frame))
toy_vertical <- do.call(rbind, lapply(vertical_list, as.data.frame))
toy <- rbind(toy_horizontal, toy_vertical)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim1, my_eig_vecs$dim2)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim2, my_eig_vecs$dim3)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
plot(my_eig_vecs$dim3, my_eig_vecs$dim4)
load(file="horizontal_bars.Rda")
load(file="vertical_bars.Rda")
# Convert list of arrays to dataframe
toy_horizontal <- do.call(rbind, lapply(horizontal_list, as.data.frame))
toy_horizontal$lab <- 1
toy_vertical <- do.call(rbind, lapply(vertical_list, as.data.frame))
toy_vertical$lab <- 2
toy <- rbind(toy_horizontal, toy_vertical)
my_eig_vecs$lab <- toy$lab
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
my_eig_vecs$lab <- toy$lab
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2,col=~lab,size = c(0.8))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2, k=',k), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
}
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
my_eig_vecs$lab <- toy$lab
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2,col=~lab,size = c(0.8))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2, k=',k), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
table(my_eig_vecs$lab)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
my_eig_vecs$lab <- toy$lab
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2,col=~lab,size = c(0.8))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2, k=',k), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
my_eig_vecs$lab <- toy$lab
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2,col=~lab,size = c(0.8),colors = c('#4AC6B7', '#1972A4', '#965F8A', '#FF7070', '#C61951'))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2, k=',k), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2,col=~lab,size = c(0.8),colors = c('#4AC6B7', '#1972A4', '#965F8A', '#FF7070', '#C61951'))
fig_le1 <- fig_le1 %>% add_markers()
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
my_eig_vecs$lab <- toy$lab
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2,col=~lab,size = c(0.8),colors = c('#4AC6B7', '#1972A4', '#965F8A', '#FF7070', '#C61951'))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2, k=',k), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
print(fig_le1)
fig_le1 <- plot_ly(my_eig_vecs, x=~dim1, y=~dim2,col=~lab,size = c(0.8),colors = c('#4AC6B7', '#1972A4', '#965F8A', '#FF7070', '#C61951'))
fig_le1 <- fig_le1 %>% add_markers()
fig_le1 <- fig_le1 %>% layout(title = paste('Embedded dimension 1 and 2'), plot_bgcolor = "#e5ecf6", xaxis = list(title = 'Embedded dim 1'),
yaxis = list(title = 'Embedded dim 2'), legend = list(title=list(text='<b> Species of Iris </b>')))
print(fig_le1)
my_eig_vecs <- as.data.frame(my_lapeig(dframe=toy,k=10,t=0.01,ndim=4)$eigenvectors)
colnames(my_eig_vecs) <- c("dim1","dim2","dim3","dim4")
my_eig_vecs$lab <- toy$lab
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,ylim = c(0,0.05))
text(my_eig_vecs$dim1, my_eig_vecs$dim2, labels = rownames(df), pos = 3, cex=0.5)
plot(my_eig_vecs$dim1, my_eig_vecs$dim2,col=my_eig_vecs$lab)
